# CNC仿真软件 - 功能说明

## 概述
这是一个基于MFC的专业CNC仿真软件，支持G代码解析、图形显示、仿真控制等功能。

## 主要功能

### 1. G代码解析
- 支持标准G代码指令：G00, G01, G02, G03
- 支持模态代码：G17/G18/G19 (平面选择), G90/G91 (坐标模式)
- 支持M代码：M03, M05, M30
- 支持多个G代码在同一行的解析
- 支持注释行处理

### 2. 专业CNC界面
- 深色专业背景
- 左侧图形显示区域
- 右侧分为信息显示和代码编辑区域
- 底部控制面板
- 经典CNC绿色显示文字

### 3. 图形显示功能
- 专业网格背景（5mm细网格，10mm主网格）
- 坐标系显示（带箭头和标签）
- 工作区域边界显示
- 刀具路径显示：
  - 红色实线：进给移动（G01）
  - 灰色虚线：快速移动（G00）
  - 蓝色实线：圆弧移动（G02/G03）
  - 绿色粗线：已执行路径
  - 黄色粗线：当前执行路径
- 起点和终点标记
- 实时刀具位置显示

### 4. 仿真控制
- 循环启动/暂停/停止
- 复位功能
- 单段执行模式
- 进给倍率控制（10%-200%）
- 主轴倍率控制（10%-200%）
- 急停功能

### 5. 状态监控
- 绝对坐标显示（X, Y, Z）
- 系统状态显示
- 当前执行行号
- 进给速度和主轴转速
- 运行时间统计
- 进度百分比
- 模态信息显示
- 倍率信息显示

### 6. 手动控制
- 手动模式切换
- X/Y/Z轴点动控制
- 可选移动步长：0.01, 0.1, 1.0, 10.0 mm
- 回零功能
- 限位检查

## 测试用G代码
项目包含两个测试文件：
- `sample.nc` - 红色阶梯路径铣削程序
- `test_red_stairs.nc` - 测试程序

## 使用方法
1. 启动程序
2. 使用控制面板的"打开文件"按钮加载G代码文件
3. 点击"循环启动"开始仿真
4. 使用倍率滑块调整仿真速度
5. 可切换到手动模式进行手动控制

## 技术特点
- 基于MFC框架
- 文档/视图架构
- 分割窗口布局
- 双缓冲绘图
- 状态机控制
- 实时更新机制

## 文件结构
- `CNCSimulatorDoc` - 文档类，负责G代码解析和仿真逻辑
- `GraphicsView` - 图形显示视图
- `InfoView` - 信息显示视图
- `CodeEditView` - 代码编辑视图
- `ControlPanel` - 控制面板对话框
- `MainFrm` - 主框架窗口

## 改进点
1. 支持多G代码同行解析
2. 专业CNC界面风格
3. 完善的状态监控
4. 单段执行功能
5. 手动控制增强
6. 运行时间统计
7. 进度显示
